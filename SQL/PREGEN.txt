-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public."Supplier"
(
    s_id serial NOT NULL,
    s_name character varying(255) NOT NULL,
    s_site character varying(255) NOT NULL,
    s_description character varying(255) NOT NULL,
    CONSTRAINT s_id PRIMARY KEY (s_id),
    CONSTRAINT s_unique UNIQUE (s_id)
);

CREATE TABLE IF NOT EXISTS public."Supply"
(
    sp_id serial NOT NULL,
    sp_item character varying(255) NOT NULL,
    sp_date character varying(255) NOT NULL,
    sp_total integer NOT NULL,
    s_id integer NOT NULL,
    CONSTRAINT sp_key PRIMARY KEY (sp_id),
    CONSTRAINT sp_unique UNIQUE (sp_id)
);

CREATE TABLE IF NOT EXISTS public."Product"
(
    p_id serial NOT NULL,
    p_brand character varying(255) NOT NULL,
    p_name character varying(255) NOT NULL,
    p_description character varying(255) NOT NULL,
    p_price integer NOT NULL,
    p_category character varying(255) NOT NULL,
    CONSTRAINT p_key PRIMARY KEY (p_id),
    CONSTRAINT p_unique UNIQUE (p_id)
);

CREATE TABLE IF NOT EXISTS public."Order"
(
    o_id serial NOT NULL,
    c_id integer,
    p_id integer,
    o_date character varying(255) NOT NULL,
    CONSTRAINT o_key PRIMARY KEY (o_id),
    CONSTRAINT o_unique UNIQUE (o_id)
);

CREATE TABLE IF NOT EXISTS public."Client"
(
    c_id serial NOT NULL,
    c_fio character varying(255) NOT NULL,
    c_city character varying(255) NOT NULL,
    c_address character varying(255) NOT NULL,
    c_phone character varying(255) NOT NULL,
    CONSTRAINT c_key PRIMARY KEY (c_id),
    CONSTRAINT c_unique UNIQUE (c_id)
);

CREATE TABLE IF NOT EXISTS public."Warehouse"
(
    w_id serial NOT NULL,
    p_id integer,
    sp_id integer,
    w_action character varying(255) NOT NULL,
    w_time timestamp without time zone NOT NULL DEFAULT NOW(),
    CONSTRAINT w_key PRIMARY KEY (w_id),
    CONSTRAINT w_unique UNIQUE (w_id)
);

ALTER TABLE IF EXISTS public."Supply"
    ADD CONSTRAINT s_id_fk FOREIGN KEY (s_id)
    REFERENCES public."Supplier" (s_id) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE SET NULL
    NOT VALID;


ALTER TABLE IF EXISTS public."Order"
    ADD CONSTRAINT c_id_fk FOREIGN KEY (c_id)
    REFERENCES public."Client" (c_id) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE SET NULL
    NOT VALID;


ALTER TABLE IF EXISTS public."Order"
    ADD CONSTRAINT p_id_fk FOREIGN KEY (p_id)
    REFERENCES public."Product" (p_id) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE SET NULL
    NOT VALID;


ALTER TABLE IF EXISTS public."Warehouse"
    ADD CONSTRAINT p_id_fk FOREIGN KEY (p_id)
    REFERENCES public."Product" (p_id) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE
    NOT VALID;


ALTER TABLE IF EXISTS public."Warehouse"
    ADD CONSTRAINT sp_id_fk FOREIGN KEY (sp_id)
    REFERENCES public."Supply" (sp_id) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE
    NOT VALID;

END;